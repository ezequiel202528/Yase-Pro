<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>YaSe PRO - Cadastro de Remessas de Selos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="Remessas/style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  </head>
  <body>
    <aside>
      <div class="mb-10 flex items-center gap-3">
        <div class="w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center">
          <i class="fa-solid fa-fire-extinguisher text-xl text-slate-900"></i>
        </div>
        <div>
          <h1 class="text-xl font-extrabold tracking-tight">YaSe <span class="text-amber-500">PRO</span></h1>
          <p class="text-[9px] text-slate-400 font-bold tracking-widest uppercase">Sistema de Rastreio</p>
        </div>
      </div>
      <nav class="space-y-2 flex-1">
        <a href="Rastreio_Full.html" class="flex items-center gap-3 p-3 text-slate-400 hover:text-white transition-all font-bold text-sm"><i class="fa-solid fa-chart-pie"></i>Rastreio</a>
      </nav>
      <div class="mt-auto pt-6 border-t border-slate-800">
        <div class="bg-slate-800/50 p-4 rounded-2xl text-xs font-bold text-white uppercase tracking-widest text-center">Configurações</div>
      </div>
    </aside>

    <main>
      <div class="flex justify-between items-center mb-6">
        <div>
          <h2 class="text-2xl font-extrabold text-slate-800 tracking-tight">Remessas de Selos</h2>
          <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">Controle e Lote de Selos Inmetro</p>
        </div>
        <div class="flex gap-3">
          <button onclick="salvarLote()" class="btn-action bg-emerald-500 text-white hover:bg-emerald-600 shadow-lg shadow-emerald-500/20">
            <i class="fa-solid fa-floppy-disk"></i> Gravar Lote
          </button>
          <button onclick="limparCampos()" class="btn-action bg-white text-red-500 border border-red-100 hover:bg-red-50">
            <i class="fa-solid fa-eraser"></i> Limpar
          </button>
        </div>
      </div>

      <div class="section-card grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-4 border-t-4 border-t-indigo-500 mb-6">
        <div class="md:col-span-1">
          <label class="label-mini">Data de Recebimento</label>
          <input type="date" id="data_rec" class="input-field">
        </div>
        <div>
          <label class="label-mini">Tipo de Selo</label>
          <select id="tipo_selo" class="input-field">
            <option>NUMÉRICO</option>
            <option>ALFA-NUMÉRICO</option>
          </select>
        </div>
        <div>
          <label class="label-mini">Selo Inicial</label>
          <input type="number" id="selo_inicio" class="input-field" placeholder="Ex: 10001">
        </div>
        <div>
          <label class="label-mini">Selo Final</label>
          <input type="number" id="selo_fim" class="input-field" placeholder="Ex: 20000">
        </div>
        <div>
          <label class="label-mini">Quantidade</label>
          <input type="number" id="qtd_selos" class="input-field bg-slate-100 font-black text-indigo-600" readonly>
        </div>
        <div>
          <label class="label-mini">Prefixo</label>
          <input type="text" id="prefixo" class="input-field" placeholder="Ex: ABC">
        </div>
        <div class="md:col-span-4">
          <label class="label-mini">Num. Solicitação / NF-e</label>
          <input type="text" id="documento" class="input-field" placeholder="Identificação da Nota Fiscal ou Pedido">
        </div>
        <div class="md:col-span-2">
            <label class="label-mini">Situação do Lote</label>
            <select id="status_lote" class="input-field">
              <option value="ABERTO">ABERTO</option>
              <option value="FECHADO">FECHADO / ESGOTADO</option>
              <option value="CANCELADO">CANCELADO</option>
            </select>
        </div>
      </div>

      <section class="section-card !p-0 overflow-hidden mb-6">
        <div class="bg-slate-50 p-4 border-b">
            <h3 class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Histórico de Lotes Gravados</h3>
        </div>
        <div class="overflow-x-auto">
          <table class="w-full text-left border-collapse">
            <thead class="bg-slate-50 text-[9px] uppercase font-black text-slate-400 border-b">
              <tr>
                <th class="p-4">Data</th>
                <th class="p-4">Tipo</th>
                <th class="p-4">Selo Inicial</th>
                <th class="p-4">Selo Final</th>
                <th class="p-4 text-center">Qtd.</th>
                <th class="p-4">Solicitação/NF</th>
                <th class="p-4">Situação</th>
                <th class="p-4 text-center">Ações</th>
              </tr>
            </thead>
            <tbody id="lista-remessas" class="text-[11px] font-bold text-slate-700"></tbody>
          </table>
        </div>
      </section>

      <section class="section-card mt-4 bg-slate-50 border border-slate-200 !p-4">
        <div class="flex flex-col gap-2">
          <span class="text-[10px] font-black text-purple-600 uppercase tracking-widest">Quantidade Total de Selos (Lotes Abertos)</span>
          <div class="flex flex-wrap items-end gap-2">
            <div class="flex flex-col">
              <label class="text-[9px] text-slate-400 font-bold uppercase mb-1">Última Remessa</label>
              <input type="text" id="resumo_data" class="input-field !py-1 !px-2 !text-center w-[100px] bg-slate-100 font-bold" readonly>
            </div>
            <span class="text-slate-300 font-bold mb-2">/</span>
            <div class="flex flex-col">
              <label class="text-[9px] text-slate-400 font-bold uppercase mb-1">Total Recebido</label>
              <input type="text" id="resumo_total" class="input-field !py-1 !px-2 !text-center w-[90px] bg-slate-100 font-bold" readonly>
            </div>
            <span class="text-slate-300 font-bold mb-2">-</span>
            <div class="flex flex-col">
              <label class="text-[9px] text-slate-400 font-bold uppercase mb-1">Utilizados</label>
              <input type="number" id="resumo_utilizados" class="input-field !py-1 !px-2 !text-center w-[80px] text-red-500 font-bold" value="0" oninput="calcularSaldoFinal()">
            </div>
            <span class="text-slate-300 font-bold mb-2">-</span>
            <div class="flex flex-col">
              <label class="text-[9px] text-slate-400 font-bold uppercase mb-1">Inutilizados</label>
              <input type="number" id="resumo_inutilizados" class="input-field !py-1 !px-2 !text-center w-[80px] text-orange-500 font-bold" value="0" oninput="calcularSaldoFinal()">
            </div>
            <span class="text-slate-300 font-bold mb-2">=</span>
            <div class="flex flex-col">
              <label class="text-[9px] text-slate-400 font-bold uppercase mb-1">Estoque Atual</label>
              <input type="text" id="resumo_estoque" class="input-field !py-1 !px-2 !text-center w-[110px] !bg-yellow-300 font-black text-slate-900 shadow-sm" readonly>
            </div>
            <button onclick="atualizarResumoLotes()" class="btn-action bg-slate-200 text-slate-700 hover:bg-slate-300 !py-1.5 !px-4 text-[10px] font-black border border-slate-300">
              ATUALIZAR
            </button>
          </div>
        </div>
      </section>
    </main>

    <script src="Rastreabilidade/main.js"></script> 
    <script src="Remessas/main.js"></script>
    <script src="Remessas/calculosSelos.js"></script>
  </body>
</html>